# FontTools Subset Generator

日本語フォントの柔軟なサブセット化とWebフォント（WOFF2）生成を行うコマンドラインツールです。

## 機能

- **階層的文字セット選択**: 用途に応じて必要な文字のみを選択可能
- **マルチフォーマット対応**: TTF、OTF、WOFF、WOFF2形式のフォントファイルを自動検出・処理
- **WOFF2出力**: Web配信に最適化されたフォント形式で出力
- **柔軟なカスタマイズ**: 独自の文字セット定義ファイルを追加可能
- **バッチ処理**: 複数フォントファイルの一括処理に対応

## 動作環境

### システム要件

- **Python**: 3.6以上
- **OS**: Windows（バッチファイル実行環境）
- **依存関係**: fonttools[woff]（自動インストール）

### 事前準備

Pythonがインストールされていることを確認してください：

```bash
python --version
pip --version
```

Pythonがインストールされていない場合は、[公式サイト](https://www.python.org/downloads/)からダウンロードしてインストールしてください。

## 使用方法

### 基本的な使用手順

1. **フォントファイルの準備**
   ```
   src/ フォルダに対象のフォントファイルを配置
   サポート形式: TTF, OTF, WOFF, WOFF2
   ```

2. **ツールの実行**
   ```
   main.bat をダブルクリックして起動
   ```

3. **文字セットの設定**
   ```
   対話形式で必要な文字セットを選択
   各項目に対して y（使用）/n（不使用）で回答
   ```

4. **結果の確認**
   ```
   dist/ フォルダに最適化されたWOFF2ファイルが出力
   report.md に処理結果の詳細が記録
   ```

## 文字セット

本ツールでは以下の文字セットから必要なものを選択してサブセット化を行います：

- **基本文字セット**: 英数字・記号類（半角・全角）
- **仮名文字セット**: ひらがな・カタカナ（全角・半角）
- **漢字セット**: JIS第一〜第四水準漢字
- **補完セット**: 常用漢字・人名漢字（JIS水準との差分補完）

### 文字セット定義ファイル

各文字セットの詳細は以下のファイルで定義されています：

#### 基本文字セット
- [オプション](libs/オプション.txt) - 常時追加される基本文字定義
- [半角英数字](libs/半角英数字.txt) - ASCII英数字（A-Z, a-z, 0-9）
- [全角英数字](libs/全角英数字.txt) - 全角英数字（Ａ-Ｚ、ａ-ｚ、０-９）
- [半角記号](libs/半角記号.txt) - ASCII記号文字
- [全角記号](libs/全角記号.txt) - 全角記号文字

#### 仮名文字セット
- [ひらがな](libs/ひらがな.txt) - ひらがな文字集合
- [カタカナ](libs/カタカナ.txt) - 全角カタカナ文字集合
- [半角カタカナ](libs/半角カタカナ.txt) - 半角カタカナ文字集合

#### JIS漢字セット
- [JIS第一水準漢字](libs/JIS第一水準漢字.txt) - JIS X 0208第一水準漢字（2,965字）
- [JIS第二水準漢字](libs/JIS第二水準漢字.txt) - JIS X 0208第二水準漢字（3,390字）
- [JIS第三水準漢字](libs/JIS第三水準漢字.txt) - JIS X 0213第三水準漢字（1,259字）
- [JIS第四水準漢字](libs/JIS第四水準漢字.txt) - JIS X 0213第四水準漢字（2,436字）

#### 補完用漢字セット
- [常用漢字](libs/常用漢字.txt) - 常用漢字表準拠（2,136字）
- [人名漢字](libs/人名漢字.txt) - 人名用漢字（863字）
- [第一水準漢字に含まれない常用漢字](libs/第一水準漢字に含まれない常用漢字.txt) - 差分補完用
- [第一水準漢字に含まれない人名漢字](libs/第一水準漢字に含まれない人名漢字.txt) - 差分補完用

## ファイル構成

```
FontTools/
├── main.bat                                    # メイン実行ファイル
├── main.py                                     # Python スクリプト
├── README.md                                   # このファイル
├── libs/                                       # 文字セットファイル
│   ├── オプション.txt                             # 必ず追加される基本文字
│   ├── ひらがな.txt
│   ├── カタカナ.txt
│   ├── 半角カタカナ.txt
│   ├── 半角英数字.txt
│   ├── 全角英数字.txt
│   ├── 半角記号.txt
│   ├── 全角記号.txt
│   ├── JIS第一水準漢字.txt
│   ├── JIS第二水準漢字.txt
│   ├── JIS第三水準漢字.txt
│   ├── JIS第四水準漢字.txt
│   ├── 常用漢字.txt
│   ├── 人名漢字.txt
│   ├── 第一水準漢字に含まれない常用漢字.txt
│   └── 第一水準漢字に含まれない人名漢字.txt
├── src/                                        # フォントファイル配置場所
│   ├── フォント名1.ttf                          # TrueType
│   ├── フォント名2.otf                          # OpenType
│   ├── フォント名3.woff                         # WOFF
│   ├── フォント名4.woff2                        # WOFF2
│   └── （その他のフォントファイル）
└── dist/                                       # 出力先（実行後に生成）
    ├── フォント名1.woff2                        # サブセット化されたWOFF2ファイル
    ├── フォント名2.woff2
    ├── （その他の.woff2ファイル）
    └── report.md                               # 使用した文字セットの詳細
```

## カスタマイズ

### カスタム文字セットの作成

独自の文字セットを定義する場合：

1. **ファイル作成**: `libs/` ディレクトリに新しい `.txt` ファイルを作成
2. **フォーマット**: 
   - 1行目: 文字セットの説明文
   - 2行目以降: 含める文字を1文字ずつ改行区切りで記述
3. **プログラム連携**: 必要に応じて `main.py` の選択フローに組み込み

### 基本文字セットの編集

`libs/オプション.txt` を編集することで、全サブセットに自動的に含まれる基本文字を変更できます。

## トラブルシューティング

### Pythonコマンドが認識されない場合

**エラー例:**
```
'python' は、内部コマンドまたは外部コマンド、
操作可能なプログラムまたはバッチ ファイルとして認識されていません。
```

**解決方法:**
- Pythonが正しくインストールされているか確認
- 環境変数PATHにPythonのパスが追加されているか確認
- コマンドプロンプトを再起動後に再実行

### 依存関係のインストールエラー

fonttools[woff]パッケージのインストールに失敗する場合：

```bash
pip install --upgrade pip
pip install fonttools[woff]
```

### 文字化けが発生する場合

- ターミナルの文字エンコーディングをUTF-8に設定
- 使用する文字セットファイルがUTF-8エンコーディングで保存されているか確認

